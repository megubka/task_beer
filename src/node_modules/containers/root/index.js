import React, { Component } from 'react'
import { BrowserRouter as Router, Route, Switch, Link } from 'react-router-dom'

import Layout from 'containers/layout'
import Modal from 'containers/modal'

class Root extends Component {

    //Doing a modal window using react router
    previousLocation = this.props.location;

    componentWillUpdate(nextProps) {
        const { location } = this.props;
        // set previousLocation if props.location is not modal
        if (
            nextProps.history.action !== "POP" &&
            (!location.state || !location.state.modal)
        ) {
            this.previousLocation = this.props.location;
        }
    }

    render() {
        const { location } = this.props
        const isModal = !!(
            location.state &&
            location.state.modal &&
            this.previousLocation !== location
        ) // not initial render
        return (
            <div>
                <Switch location={isModal ? this.previousLocation : location}>
                    <Route exact path='/' component={Layout} />
                </Switch>
                {isModal ? <Route path="/details/:id" render={props=> <Modal {...props} />} /> : null}
            </div>
        );
    }
}

export default Root